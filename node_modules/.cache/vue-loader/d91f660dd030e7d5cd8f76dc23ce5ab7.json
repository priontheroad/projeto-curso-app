{"remainingRequest":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/src/components/ArquivosDiversos/Modal/ModalUploadXML.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/src/components/ArquivosDiversos/Modal/ModalUploadXML.vue","mtime":1678361197239},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBGb3JtIGZyb20gIkAvc2VydmljZXMvbW9kdWxlcy9mb3JtIjsKaW1wb3J0IE1vZGFsUmVzdW1vWE1MIGZyb20gIi4vTW9kYWxSZXN1bW9YTUwudnVlIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7IE1vZGFsUmVzdW1vWE1MIH0sCgogIG5hbWU6ICJNb2RhbFVwbG9hZFhNTCIsCgogIHByb3BzOiBbInZpc2libGUiXSwKCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGhhbmRsZU1vZGFsUmVzdW1vOiBmYWxzZSwKICAgICAgZGFkb3NfeG1sOiAiIiwKICAgICAgZHJhZ2dpbmc6IGZhbHNlLAogICAgICBhcnF1aXZvOiBudWxsLAogICAgICBhcnF1aXZvRXJybzogZmFsc2UsCiAgICAgIGxvYWRpbmdFbnZpbzogZmFsc2UsCiAgICB9OwogIH0sCgogIGNvbXB1dGVkOiB7CiAgICBtb2RhbFVwbG9hZDogewogICAgICBnZXQoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMudmlzaWJsZTsKICAgICAgfSwKICAgICAgc2V0KHZhbHVlKSB7CiAgICAgICAgaWYgKCF2YWx1ZSkgewogICAgICAgICAgdGhpcy4kZW1pdCgiY2xvc2UiKTsKICAgICAgICAgIHRoaXMuYXJxdWl2byA9IG51bGw7CiAgICAgICAgICB0aGlzLmFycXVpdm9FcnJvID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9LAogICAgfSwKCiAgICBsb2FkaW5nOiB7CiAgICAgIGdldCgpIHsKICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUubG9hZGluZy5sb2FkaW5nOwogICAgICB9LAogICAgICBzZXQobmV3VmFsdWUpIHsKICAgICAgICBpZiAobmV3VmFsdWUgIT0gdGhpcy5sb2FkaW5nKSB7CiAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoImxvYWRpbmcvc2V0TG9hZGluZyIsIG5ld1ZhbHVlKTsKICAgICAgICB9CiAgICAgIH0sCiAgICB9LAogIH0sCgogIHdhdGNoOiB7CiAgICBhcnF1aXZvKHZhbCkgewogICAgICBpZiAoIXZhbCkgewogICAgICAgIHRoaXMuYXJxdWl2b0Vycm8gPSBmYWxzZTsKICAgICAgICB0aGlzLmxvYWRpbmdFbnZpbyA9IGZhbHNlOwogICAgICB9CiAgICB9LAogIH0sCgogIG1ldGhvZHM6IHsKICAgIGZlY2hhcigpIHsKICAgICAgdGhpcy5tb2RhbFVwbG9hZCA9IGZhbHNlCiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgibW9kYWxOb3ZhU2ltdWxhY2FvL3NldE1vZGFsTm92YVNpbXVsYWNhbyIsIGZhbHNlKTsKICAgIH0sCgogICAgZmVjaGFyTW9kYWxSZXN1bW8oKSB7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgibW9kYWxOb3ZhU2ltdWxhY2FvL3NldE1vZGFsTm92YVNpbXVsYWNhbyIsIGZhbHNlKTsKICAgICAgdGhpcy5oYW5kbGVNb2RhbFJlc3VtbyA9IGZhbHNlOwogICAgfSwKCiAgICBhc3luYyBlbnZpYXJYTUwoKSB7CiAgICAgIGlmICghdGhpcy5hcnF1aXZvKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLmxvYWRpbmdFbnZpbyA9IHRydWU7CgogICAgICBsZXQgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsKICAgICAgZm9ybURhdGEuYXBwZW5kKCJhcnF1aXZvIiwgdGhpcy5hcnF1aXZvKTsKCiAgICAgIGxldCByZXNwb25zZSA9IGF3YWl0IHRoaXMuJHJvb3QuJGFwaS5wb3N0RmlsZVhNTCgiL2RlY2xhcmFjYW8vaW1wb3J0YXJYTUwiLCBmb3JtRGF0YSk7CgogICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09IDIwMCkgewogICAgICAgIGxldCBpZERlY2xhcmFjYW8gPSByZXNwb25zZS5kYXRhOwoKICAgICAgICBsZXQgZGVjbGFyYWNhbyA9IGF3YWl0IHRoaXMuJHJvb3QuJGFwaS5nZXQoIi9kZWNsYXJhY2FvL2xpc3Rhci8iICsgaWREZWNsYXJhY2FvKTsKICAgICAgICBsZXQgYWRpY29lcyA9IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJhZGljb2VzL2NhcnJlZ2FyQWRpY29lcyIsIGlkRGVjbGFyYWNhbyk7CgogICAgICAgIFByb21pc2UuYWxsKFtkZWNsYXJhY2FvLCBhZGljb2VzXSkudGhlbigoKSA9PiB7CiAgICAgICAgICB0aGlzLmFycXVpdm8gPSBudWxsOwogICAgICAgICAgdGhpcy5kYWRvc194bWwgPSBkZWNsYXJhY2FvLmRhdGE7CgogICAgICAgICAgbGV0IGZvcm0gPSBuZXcgRm9ybSgpOwogICAgICAgICAgZm9ybS5jYXJyZWdhckluZm9Db25zdWx0YShkZWNsYXJhY2FvLmRhdGEpOwogICAgICAgICAgZm9ybS5jYXJyZWdhclJlc3VsdGFkb1RlbGFTaW1wbGVzKGRlY2xhcmFjYW8uZGF0YSk7CgogICAgICAgICAgdGhpcy5oYW5kbGVNb2RhbFJlc3VtbyA9IHRydWU7CiAgICAgICAgICB0aGlzLm1vZGFsVXBsb2FkID0gZmFsc2U7CiAgICAgICAgICB0aGlzLmxvYWRpbmdFbnZpbyA9IGZhbHNlOwogICAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICAgIHRoaXMubG9hZGluZ0VudmlvID0gZmFsc2U7CiAgICAgICAgICB0aGlzLmhhbmRsZU1vZGFsUmVzdW1vID0gZmFsc2U7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5hcnF1aXZvRXJybyA9IHRydWU7CiAgICAgICAgdGhpcy5oYW5kbGVNb2RhbFJlc3VtbyA9IGZhbHNlOwogICAgICB9CiAgICB9LAoKICAgIG9uQ2hhbmdlKGUpIHsKICAgICAgdmFyIGZpbGVzID0gZS50YXJnZXQuZmlsZXMgfHwgZS5kYXRhVHJhbnNmZXIuZmlsZXM7CgogICAgICBpZiAoIWZpbGVzLmxlbmd0aCkgewogICAgICAgIHRoaXMuZHJhZ2dpbmcgPSBmYWxzZTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGxldCBmaWxlID0gZmlsZXNbMF07CgogICAgICBpZiAoIWZpbGUudHlwZS5tYXRjaCgidGV4dC94bWwiKSkgewogICAgICAgIHRoaXMuZHJhZ2dpbmcgPSBmYWxzZTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuYXJxdWl2byA9IGZpbGU7CiAgICAgIHRoaXMuZHJhZ2dpbmcgPSBmYWxzZTsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["ModalUploadXML.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+FA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"ModalUploadXML.vue","sourceRoot":"src/components/ArquivosDiversos/Modal","sourcesContent":["<template>\n  <v-dialog v-model=\"modalUpload\" width=\"650px\" persistent>\n    <div class=\"div-upload-xml\">\n      <v-row>\n        <v-col align=\"start\" cols=\"10\">\n          <span class=\"span-criar ml-2 mt-2\">Criar Consulta</span>\n          <span class=\"span-importar ml-2\">Importar DI</span>\n        </v-col>\n        <v-col align=\"end\" cols=\"2\">\n          <v-btn @click=\"fechar()\" icon color=\"red\">\n            <v-icon>mdi-close</v-icon>\n          </v-btn>\n        </v-col>\n      </v-row>\n\n      <p class=\"text-center texto-envio my-4\">Faça o envio do arquivo .xml para importar os dados da DI.</p>\n\n      <div class=\"quadro-alerta-romaneio\">\n        <v-icon color=\"#FFC400\">mdi-alert-outline</v-icon>\n        É necessário estar com o <strong>Romaneio de Carga</strong> em mãos para prosseguir.\n      </div>\n\n      <div\n        v-if=\"!arquivo\"\n        class=\"text-center div-arquivo-vazio my-4\"\n        :class=\"dragging ? 'arrastar-over' : ''\"\n      >\n        <v-icon color=\"#0098DA\" class=\"pt-10\" size=\"50\">mdi-cloud-upload-outline</v-icon>\n        <div class=\"pt-4\">\n          <p class=\"span-importar ma-0\">Enviar Arquivo</p>\n          <span class=\"texto-envio\">Arraste ou <a href=\"#\">clique aqui</a> para enviar a DI no formato XML.</span>\n        </div>\n        <input\n          class=\"input-arquivo\"\n          @dragenter=\"dragging = true\"\n          @dragleave=\"dragging = false\"\n          type=\"file\"\n          @change=\"onChange\"\n          @drag=\"onChange\"\n          accept=\".xml\"\n        />\n      </div>\n\n      <div v-else class=\"text-center div-arquivo-selecionado\">\n        <v-icon color=\"#0098DA\" class=\"pt-4\" size=\"50\">mdi-cloud-upload-outline</v-icon>\n        <p class=\"span-arquivo-selecionado ma-0\">Arquivo Selecionado</p>\n        <p class=\"span-nome-arquivo mt-2\">{{ arquivo.name }}</p>\n        <v-row class=\"quadro-aviso-envio mb-2\">\n          <v-col cols=\"1\" align=\"center\">\n            <v-icon small color=\"#17C3E6\">mdi-information-outline</v-icon>\n          </v-col>\n          <v-col cols=\"11\" align=\"start\">\n            O arquivo enviado <strong>não será armazenado</strong> em nossos servidores.<br />\n            A consulta será mantida por 120 dias.\n          </v-col>\n        </v-row>\n        <div class=\"div-botao-trocar mr-1 mb-1\">\n          <v-btn\n            text\n            class=\"text-none\"\n            elevation=\"0\"\n            color=\"primary\"\n            small\n            @click=\"arquivo = null\"\n            :disabled=\"loadingEnvio && !arquivoErro\"\n          >\n            Trocar Arquivo\n            <v-icon color=\"primary\" right small>mdi-cloud-upload-outline</v-icon>\n          </v-btn>\n        </div>\n      </div>\n\n      <div v-if=\"arquivo\" class=\"div-botao-criar mt-4 mr-2\">\n        <v-btn\n          color=\"primary\"\n          small\n          @click=\"enviarXML()\"\n          v-if=\"!arquivoErro\"\n          :loading=\"loadingEnvio\"\n        >\n          Criar Consulta <v-icon small right>mdi-arrow-right</v-icon>\n        </v-btn>\n        <v-btn disabled v-else text>Arquivo inválido!</v-btn>\n      </div>\n    </div>\n\n    <ModalResumoXML\n      v-if=\"dados_xml.bl_xml == 1\"\n      :visible=\"handleModalResumo\"\n      :dados=\"dados_xml\"\n      @fechar=\"fecharModalResumo()\"\n    />\n  </v-dialog>\n</template>\n<script>\nimport Form from \"@/services/modules/form\";\nimport ModalResumoXML from \"./ModalResumoXML.vue\";\n\nexport default {\n  components: { ModalResumoXML },\n\n  name: \"ModalUploadXML\",\n\n  props: [\"visible\"],\n\n  data() {\n    return {\n      handleModalResumo: false,\n      dados_xml: \"\",\n      dragging: false,\n      arquivo: null,\n      arquivoErro: false,\n      loadingEnvio: false,\n    };\n  },\n\n  computed: {\n    modalUpload: {\n      get() {\n        return this.visible;\n      },\n      set(value) {\n        if (!value) {\n          this.$emit(\"close\");\n          this.arquivo = null;\n          this.arquivoErro = false;\n        }\n      },\n    },\n\n    loading: {\n      get() {\n        return this.$store.state.loading.loading;\n      },\n      set(newValue) {\n        if (newValue != this.loading) {\n          this.$store.commit(\"loading/setLoading\", newValue);\n        }\n      },\n    },\n  },\n\n  watch: {\n    arquivo(val) {\n      if (!val) {\n        this.arquivoErro = false;\n        this.loadingEnvio = false;\n      }\n    },\n  },\n\n  methods: {\n    fechar() {\n      this.modalUpload = false\n      this.$store.commit(\"modalNovaSimulacao/setModalNovaSimulacao\", false);\n    },\n\n    fecharModalResumo() {\n      this.$store.commit(\"modalNovaSimulacao/setModalNovaSimulacao\", false);\n      this.handleModalResumo = false;\n    },\n\n    async enviarXML() {\n      if (!this.arquivo) {\n        return;\n      }\n\n      this.loadingEnvio = true;\n\n      let formData = new FormData();\n      formData.append(\"arquivo\", this.arquivo);\n\n      let response = await this.$root.$api.postFileXML(\"/declaracao/importarXML\", formData);\n\n      if (response.status == 200) {\n        let idDeclaracao = response.data;\n\n        let declaracao = await this.$root.$api.get(\"/declaracao/listar/\" + idDeclaracao);\n        let adicoes = this.$store.dispatch(\"adicoes/carregarAdicoes\", idDeclaracao);\n\n        Promise.all([declaracao, adicoes]).then(() => {\n          this.arquivo = null;\n          this.dados_xml = declaracao.data;\n\n          let form = new Form();\n          form.carregarInfoConsulta(declaracao.data);\n          form.carregarResultadoTelaSimples(declaracao.data);\n\n          this.handleModalResumo = true;\n          this.modalUpload = false;\n          this.loadingEnvio = false;\n        }).catch(() => {\n          this.loadingEnvio = false;\n          this.handleModalResumo = false;\n        });\n      } else {\n        this.arquivoErro = true;\n        this.handleModalResumo = false;\n      }\n    },\n\n    onChange(e) {\n      var files = e.target.files || e.dataTransfer.files;\n\n      if (!files.length) {\n        this.dragging = false;\n        return;\n      }\n\n      let file = files[0];\n\n      if (!file.type.match(\"text/xml\")) {\n        this.dragging = false;\n        return;\n      }\n\n      this.arquivo = file;\n      this.dragging = false;\n    },\n  },\n};\n</script>\n<style scoped>\n.div-upload-xml {\n  background-color: white !important;\n  padding: 14px;\n  height: 450px;\n  overflow: hidden;\n}\n\n.span-criar {\n  font: normal normal 800 20px/27px Mulish;\n  letter-spacing: 0px;\n  color: #2d5071;\n}\n\n.span-importar {\n  font: normal normal normal 20px/27px Mulish;\n  letter-spacing: 0px;\n  color: #2d5071;\n}\n\n.texto-envio {\n  font: normal normal normal 12px/16px Mulish;\n  letter-spacing: 0px;\n  color: #010b14;\n}\n\n.quadro-alerta-romaneio {\n  background: #fffcf2 0% 0% no-repeat padding-box;\n  border: 1px solid #00000000;\n  font: normal normal normal 12px/16px Mulish;\n  padding: 16.5px;\n  width: 520px;\n  margin: auto;\n}\n\n.div-arquivo-vazio {\n  width: 520px;\n  height: 200px;\n  margin: auto;\n  border: 2px dashed #acb6bf;\n  border-radius: 8px;\n}\n\n.div-arquivo-selecionado {\n  width: 520px;\n  margin: auto;\n  border: 2px solid #0098da;\n  border-radius: 8px;\n}\n\n.arrastar-over {\n  background: #fff;\n  border: 2px dashed gray;\n  opacity: 0.3;\n}\n\n.input-arquivo {\n  position: relative;\n  cursor: pointer;\n  top: -160px;\n  height: 200px !important;\n  width: 100%;\n  opacity: 0;\n}\n\n.span-arquivo-selecionado {\n  color: #0098da;\n  font: normal normal normal 12px/16px Mulish;\n  letter-spacing: 0px;\n}\n\n.span-nome-arquivo {\n  font: normal normal 800 14px/24px Mulish;\n  letter-spacing: 0px;\n  color: #2d5071;\n}\n\n.quadro-aviso-envio {\n  background: #f2fdff 0% 0% no-repeat padding-box;\n  border: 1px solid #00000000;\n  font: normal normal normal 12px/16px Mulish;\n  letter-spacing: -0.5px;\n  width: 460px;\n  margin: auto;\n}\n\n.div-botao-trocar {\n  text-align: right;\n}\n\n.div-botao-criar {\n  text-align: right;\n}\n</style>"]}]}