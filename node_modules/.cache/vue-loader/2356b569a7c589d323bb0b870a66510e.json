{"remainingRequest":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/src/views/Formularios/DadosBasicos/DadosBasicos.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/src/views/Formularios/DadosBasicos/DadosBasicos.vue","mtime":1678361197243},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLndpZHRoLXNlbGVjdCB7CiAgbWF4LXdpZHRoOiAxMjVweCAhaW1wb3J0YW50OwogIG1pbi13aWR0aDogMTI1cHggIWltcG9ydGFudDsKfQoubmNtLnYtbWVudV9fY29udGVudC52LW1lbnVfX2NvbnRlbnQtLWZpeGVkIHsKICBtYXgtaGVpZ2h0OiAyNTBweCAhaW1wb3J0YW50OwogIGJhY2tncm91bmQtY29sb3I6ICNmZmZmZmY7Cn0K"},{"version":3,"sources":["DadosBasicos.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DadosBasicos.vue","sourceRoot":"src/views/Formularios/DadosBasicos","sourcesContent":["<template>\n  <div>\n    <p class=\"text-center mb-0\">\n      Pesquise abaixo o NCM da adição e preencha os dados básicos.\n    </p>\n    <p class=\"text-center mt-1\">\n      <strong>Campos com <b>*</b> são obrigatórios.</strong>\n    </p>\n\n    <v-row justify=\"center\">\n      <v-col cols=\"10\">\n        <v-row justify=\"center\" class=\"pb-0\">\n          <v-col cols=\"10\" class=\"pb-0 mb-0\">\n            <label for=\"\" class=\"text-caption\">NCM <b>*</b></label>\n            <v-autocomplete\n              :menu-props=\"{ contentClass: 'ncm' }\"\n              ref=\"Ncm\"\n              v-model=\"model\"\n              :items=\"ncm.items\"\n              :loading=\"ncm.isLoading\"\n              :search-input.sync=\"search\"\n              item-text=\"numero\"\n              outlined\n              single-line\n              placeholder=\"Digite ...\"\n              append-icon=\"\"\n              :error-messages=\"modelErrors\"\n              v-mask=\"getMask()\"\n              return-object\n            >\n              <!-- filterPesquisaNcmOrDescricao -->\n              <template v-slot:no-data>\n                <v-list-item>\n                  <v-list-item-title>\n                    Digite a\n                    <strong>NCM</strong>\n                  </v-list-item-title>\n                </v-list-item>\n              </template>\n              <template v-slot:item=\"{ item }\">\n                <v-list-item-content>\n                  <v-list-item-title v-text=\"item.numero\"></v-list-item-title>\n                  <v-list-item-subtitle v-text=\"item.descricao\"\n                    >descricao</v-list-item-subtitle\n                  >\n                </v-list-item-content>\n              </template>\n              <template v-slot:selection=\"{ item }\">\n                <span v-text=\"item.numero\"></span>\n              </template>\n              <template v-slot:append>\n                <v-progress-circular\n                  v-if=\"ncm.isLoading\"\n                  indeterminate\n                  :size=\"20\"\n                  color=\"#2D5071\"\n                ></v-progress-circular>\n              </template>\n            </v-autocomplete>\n          </v-col>\n        </v-row>\n        <div v-if=\"model !== null && model !== ''\">\n          <v-row justify=\"center\" class=\"mt-0 pt-0\">\n            <v-col cols=\"10\" class=\"mt-0 pt-0\">\n              <label class=\"text-caption\">Descrição</label>\n              <p>\n                <strong>{{ model.numero }}</strong> -- {{ model.descricao }}\n              </p>\n            </v-col>\n          </v-row>\n          <v-row justify=\"center\" no-gutters v-if=\"model.vigente == 0\">\n            <v-col cols=\"10\">\n              <div class=\"pa-2 alerta-dumping\">\n                <v-icon left color=\"#C48F14\" class=\"ml-6 mr-6 mb-1\">mdi-alert-outline</v-icon>\n                <span>NCM não vigente</span>\n              </div>\n            </v-col>\n          </v-row>\n          <v-row justify=\"center\" no-gutters>\n            <v-col cols=\"10\">\n              <div\n                class=\"pa-2 alerta-dumping\"\n                v-if=\"\n                  !aliquotas.isLoading &&\n                  aliquotas.ANTIDUMPING.alertas &&\n                  aliquotas.ANTIDUMPING.alertas.length > 0\n                \"\n              >\n                <v-icon left color=\"#C48F14\" class=\"ml-6 mr-6 mb-1\">mdi-alert-outline</v-icon>\n                <span v-html=\"aliquotas.ANTIDUMPING.alertas.join('<br>')\" />\n              </div>\n              <v-progress-circular\n                v-if=\"aliquotas.isLoading\"\n                indeterminate\n                :size=\"20\"\n                color=\"#2D5071\"\n              ></v-progress-circular>\n            </v-col>\n          </v-row>\n          <v-row justify=\"start\">\n            <v-col cols=\"3\" offset=\"1\">\n              <label class=\"text-caption\">Peso Líquido <b>*</b></label>\n              <CampoMonetario\n                v-model=\"peso_liquido_total\"\n                :errorMessages=\"pesoLiquidoTotalErrors\"\n                :intDecimais=\"5\"\n                :appendIcon=\"'Kg'\"\n              />\n            </v-col>\n            <v-col cols=\"4\">\n              <label class=\"text-caption\">Unidade de Medida <b>*</b></label>\n              <v-select\n                v-model=\"id_unidade_medida\"\n                :items=\"unidade_medida_agrupada\"\n                item-text=\"unidade\"\n                item-value=\"id\"\n                placeholder=\"Selecione\"\n                outlined\n                dense               \n                :error-messages=\"unidadeMercadoriaErrors\"\n              />\n            </v-col>\n            <v-col cols=\"3\" v-if=\"blExibeAntidumping\">\n              <label class=\"text-caption\">Antidumping</label>\n              <CampoMonetario\n                v-model=\"antidumping\"\n              />\n            </v-col>\n          </v-row>\n        </div>\n      </v-col>\n    </v-row>\n  </div>\n</template>\n<script>\nimport { mapGetters } from \"vuex\";\nimport { required } from \"vuelidate/lib/validators\";\n\nexport default {\n  name: \"DadosBasicos\",\n\n  validations: {\n    model: {\n      required,\n    },\n    peso_liquido_total: {\n      required,\n    },\n    // total_unidade_mercadoria: {\n    //   required,\n    // },\n    id_unidade_medida: {\n      required,\n    },\n    antidumping: {\n      // required\n    },\n  },\n  mounted() {\n    this.model = this.adicao.ncm;\n\n    if (this.model && this.model.numero != '') {\n      this.$store.dispatch(\"aliquotas/obterAlertaAntidumping\", {\n        ncm: this.model.numero,\n        pais: this.adicao.id_pais_exportador,\n        uf: this.consulta.codigo_estado,\n      });\n\n      if (this.ncm.items.length > 0) {\n        let ncms = this.ncm.items.filter((n) => {\n          return n.numero == this.model.ncm;\n        });\n        if (ncms[0]) {\n          this.model.vigente = ncms[0]['vigente'];\n        }\n      }\n    }\n  },\n  data() {\n    return {\n      model: null,\n      search: null,\n      timeoutProximaPesquisa: \"\",\n    };\n  },\n  watch: {\n    model(val) {\n      if (val !== null && val !== \"\" && typeof val == \"object\") {\n        let ncmAtual = this.adicao.ncm.numero;\n        this.adicao.ncm = val;\n        if (val.numero.length == 10 && val.numero != ncmAtual) {\n          this.$store.dispatch(\"adicao/resetarTributosAdicao\");\n          this.$store.dispatch(\"aliquotas/limparAliquotasEAlertas\");\n          this.$store.dispatch(\"aliquotas/obterAlertaAntidumping\", {\n            ncm: val.numero,\n            pais: this.adicao.id_pais_exportador,\n            uf: this.consulta.codigo_estado,\n          });\n          this.$store.commit('ncm/setBlVigente', val.vigente);\n        }\n      }\n    },\n    handleModalAdicao(val) {\n      if (val == true) {\n        //zerando dados do model com base no model adicao, que esta sem dados\n        this.model = this.adicao.ncm;\n\n        //limpa validacoes\n        this.limpaFormulario();\n      }\n    },\n    search(val) {\n      if (\n        typeof val !== \"undefined\" &&\n        typeof val == \"string\" &&\n        val.trim() !== \"\" &&\n        val.length >= 2\n      ) {\n        //TODO:: rever regra abaixo\n        // if (this.ncm.items.length > 0) return false;\n\n        clearTimeout(this.timeoutProximaPesquisa);\n        this.timeoutProximaPesquisa = null;\n\n        this.timeoutProximaPesquisa = setTimeout(() => {\n          this.ncm.isLoading = true;\n          let dados = {\n            ncm: this.search,\n          };\n          this.$store.dispatch(\"ncm/pesquisaNcm\", dados);\n        }, 1000);\n      }\n    },\n  },\n  computed: {\n    ...mapGetters(\"adicao\", {\n      adicao: \"getState\",\n    }),\n    ...mapGetters(\"modalAdicoes\", {\n      handleModalAdicao: \"getModalAdicoes\",\n    }),\n    ...mapGetters(\"ncm\", {\n      ncm: \"getState\",\n    }),\n    ...mapGetters(\"consulta\", {\n      consulta: \"getState\",\n    }),\n    ...mapGetters(\"aliquotas\", {\n      aliquotas: \"getState\",\n    }),\n    peso_liquido_total: {\n      get() {\n        return this.$store.state.adicao.peso_liquido_total;\n      },\n      set(newValue) {\n        if (newValue != this.peso_liquido_total) {\n          this.$store.commit(\"adicao/setPesoLiquidoTotal\", newValue);\n        }\n      },\n    },\n    total_unidade_mercadoria: {\n      get() {\n        return this.$store.state.adicao.total_unidade_mercadoria;\n      },\n      set(newValue) {\n        if (newValue != this.total_unidade_mercadoria) {\n          this.$store.commit(\"adicao/setTotalUnidadeMercadoria\", newValue);\n        }\n      },\n    },\n    id_unidade_medida: {\n      get() {\n        return this.$store.state.adicao.id_unidade_medida;\n      },\n      set(newValue) {\n        if (newValue != this.id_unidade_medida) {\n          this.$store.commit(\"adicao/setIdUnidadeMedida\", newValue);\n        }\n      },\n    },\n    antidumping: {\n      get() {\n        return this.$store.state.adicao.antidumping;\n      },\n      set(newValue) {\n        if (newValue != this.antidumping) {\n          this.$store.commit(\"adicao/setAntidumping\", newValue);\n        }\n      },\n    },\n    ...mapGetters(\"informacoesPadrao\", {\n      lista_unidade_medida: \"getUnidadeMedida\",\n      unidade_medida_agrupada: \"getUnidadeMedidaAgrupada\",\n    }),\n\n    modelErrors() {\n      const errors = [];\n      if (!this.$v.model.$dirty) return errors;\n      !this.$v.model.required && errors.push(\"ncm é obrigatório.\");\n      return errors;\n    },\n    pesoLiquidoTotalErrors() {\n      const errors = [];\n      if (!this.$v.peso_liquido_total.$dirty) return errors;\n      !this.$v.peso_liquido_total.required &&\n        errors.push(\"Peso liquido é obrigatória.\");\n      return errors;\n    },\n    // quantidadeErrors() {\n    //   const errors = [];\n    //   if (!this.$v.total_unidade_mercadoria.$dirty) return errors;\n    //   !this.$v.total_unidade_mercadoria.required &&\n    //     errors.push(\"Unidade é obrigatória.\");\n    //   return errors;\n    // },\n    unidadeMercadoriaErrors() {\n      const errors = [];\n      if (!this.$v.id_unidade_medida.$dirty) return errors;\n      !this.$v.id_unidade_medida.required &&\n        errors.push(\"Unidade é obrigatória.\");\n      return errors;\n    },\n    // antidumpingErrors(){\n    //   const errors = []\n    //   if (!this.$v.antidumping.$dirty) return errors;\n    //   !this.$v.antidumping.required && errors.push('Antidumping é obrigatória.')\n    //   return errors;\n    // }\n    blExibeAntidumping() {\n      return this.aliquotas.ANTIDUMPING?.alertas?.length > 0 || this.adicao.antidumping > 0 || this.model.vigente == 0;\n    }\n  },\n  methods: {\n    getMask() {\n      let pesquisa = this.search;\n      if (pesquisa == null || pesquisa == \"\") {\n        return \"\";\n      }\n\n      if (pesquisa.length <= 2) {\n        return \"\";\n      } else if (pesquisa.length >= 3) {\n        let terceira_letra = pesquisa.slice(2, 3);\n        if (terceira_letra.match(/[a-z]/i) !== null) {\n          return \"\";\n        } else {\n          return \"####.##.##\";\n        }\n      }\n    },\n    filterPesquisaNcmOrDescricao(item) {\n      if (\n        typeof this.search !== \"undefined\" &&\n        this.search !== null &&\n        this.search !== \"\" &&\n        typeof this.search == \"string\" &&\n        typeof item !== \"undefined\" &&\n        typeof item == \"object\" &&\n        item.ncm !== null &&\n        item.descricao !== null\n      ) {\n        if (\n          item.ncm\n            .toString()\n            .toLocaleLowerCase()\n            .indexOf(this.search.toLocaleLowerCase()) >= 0 ||\n          item.descricao\n            .toString()\n            .toLocaleLowerCase()\n            .indexOf(this.search.toLocaleLowerCase()) >= 0\n        ) {\n          return item.ncm + \"-\" + item.descricao;\n        }\n      }\n    },\n\n    limpaFormulario() {\n      this.$v.$reset();\n    },\n    verificaFormularioDadosBasicos() {\n      this.$v.$touch();\n      if (!this.$v.$invalid) {\n        return true;\n      }\n      return false;\n    },\n  },\n};\n</script>\n<style lang=\"scss\">\n.width-select {\n  max-width: 125px !important;\n  min-width: 125px !important;\n}\n.ncm.v-menu__content.v-menu__content--fixed {\n  max-height: 250px !important;\n  background-color: #ffffff;\n}\n</style>\n"]}]}