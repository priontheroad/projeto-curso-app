{"remainingRequest":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/src/components/ArquivosDiversos/Modal/ModalAdicoes.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/src/components/ArquivosDiversos/Modal/ModalAdicoes.vue","mtime":1678361197239},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5wb3NpdGlvbi1idXR0b24gewogIGZsb2F0OiByaWdodDsKfQoudGFiIHsKICBwb3NpdGlvbjogcmVsYXRpdmU7CgogIC5iYXJyYS1hY29lcyB7CiAgICBvcGFjaXR5OiAxOwogICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1KTsKICAgIGhlaWdodDogNDBweDsKICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjYjdjMmNjOwogICAgei1pbmRleDogMTUwOwogICAgcG9zaXRpb246IHN0aWNreTsKICAgIHJpZ2h0OiAwOwogICAgdG9wOiAwOwogICAgbGVmdDogMDsKICB9CgogIEBzdXBwb3J0cyAoKC13ZWJraXQtYmFja2Ryb3AtZmlsdGVyOiBub25lKSBvciAoYmFja2Ryb3AtZmlsdGVyOiBub25lKSkgewogICAgLmJhcnJhLWFjb2VzIHsKICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjYpICFpbXBvcnRhbnQ7CiAgICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cig1cHgpICFpbXBvcnRhbnQ7CiAgICAgIC13ZWJraXQtYmFja2Ryb3AtZmlsdGVyOiBibHVyKDVweCkgIWltcG9ydGFudDsKICAgIH0KICB9Cn0KCi52LWRpYWxvZyA+IC52LWNhcmQgPiAudi1jYXJkX190ZXh0IHsKICBwYWRkaW5nOiAwIDBweCA4cHggIWltcG9ydGFudDsKfQoKLmN1c3RvbS1sb2FkZXIgewogIGFuaW1hdGlvbjogbG9hZGVyIDFzIGluZmluaXRlOwogIGRpc3BsYXk6IGZsZXg7Cn0KQC1tb3ota2V5ZnJhbWVzIGxvYWRlciB7CiAgZnJvbSB7CiAgICB0cmFuc2Zvcm06IHJvdGF0ZSgwKTsKICB9CiAgdG8gewogICAgdHJhbnNmb3JtOiByb3RhdGUoMzYwZGVnKTsKICB9Cn0KQC13ZWJraXQta2V5ZnJhbWVzIGxvYWRlciB7CiAgZnJvbSB7CiAgICB0cmFuc2Zvcm06IHJvdGF0ZSgwKTsKICB9CiAgdG8gewogICAgdHJhbnNmb3JtOiByb3RhdGUoMzYwZGVnKTsKICB9Cn0KQC1vLWtleWZyYW1lcyBsb2FkZXIgewogIGZyb20gewogICAgdHJhbnNmb3JtOiByb3RhdGUoMCk7CiAgfQogIHRvIHsKICAgIHRyYW5zZm9ybTogcm90YXRlKDM2MGRlZyk7CiAgfQp9CkBrZXlmcmFtZXMgbG9hZGVyIHsKICBmcm9tIHsKICAgIHRyYW5zZm9ybTogcm90YXRlKDApOwogIH0KICB0byB7CiAgICB0cmFuc2Zvcm06IHJvdGF0ZSgzNjBkZWcpOwogIH0KfQo="},{"version":3,"sources":["ModalAdicoes.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4ZA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ModalAdicoes.vue","sourceRoot":"src/components/ArquivosDiversos/Modal","sourcesContent":["<template>\n  <div>\n    <v-dialog v-model=\"handleModalAdicao\" scrollable persistent max-width=\"60%\">\n      <v-card max-height=\"650px\" min-height=\"90vh\">\n        <v-card-title class=\"text-h5 tab\">\n          <div class=\"d-flex justify-space-between\" style=\"min-width: 100%\">\n            <template v-if=\"adicao.id == null || adicao.id == ''\">\n              <h3 class=\"standard-subtitle\">Incluir Adição</h3>\n            </template>\n            <template v-else>\n              <h3 class=\"standard-subtitle\">Editar Adição</h3>\n            </template>\n            <v-btn\n              @click.stop=\"confirmaFechamentoModalAdicao()\"\n              icon\n              color=\"red\"\n              class=\"text-h6\"\n            >\n              <v-icon>mdi-close</v-icon>\n            </v-btn>\n          </div>\n        </v-card-title>\n        <v-card-text id=\"modal_adicoes\">\n          <AbaAdicoes\n            v-if=\"handleModalAdicao\"\n            ref=\"abaAdicoes\"\n            @downScroll=\"downScroll\"\n            :adicaoEscolhida=\"adicaoEscolhida\"\n          />\n        </v-card-text>\n        <v-card-actions class=\"justify-space-between\">\n          <div>\n            <v-btn\n              @click=\"etapaAnterior()\"\n              class=\"elevation-0\"\n              text\n              color=\"primary\"\n            >\n              <v-icon small left>mdi-arrow-left</v-icon>\n              Voltar\n            </v-btn>\n          </div>\n          <div v-if=\"abaAdicoes !== 'aba-Tributos'\">\n            <v-btn class=\"elevation-0\" color=\"primary\" @click=\"proximaEtapa\">\n              Avançar\n              <v-icon small right>mdi-arrow-right</v-icon>\n            </v-btn>\n          </div>\n          <div v-if=\"abaAdicoes == 'aba-Tributos'\">\n            <template v-if=\"adicao.id == null || adicao.id == ''\">\n              <div class=\"d-flex\">\n                <v-checkbox dense v-model=\"checkManterExpoFab\" label=\"Manter Exportador/Fabricante/Produtor\" class=\"pr-4 pt-1\" />\n                <v-btn\n                  :loading=\"loadingIncluir\"\n                  @click=\"salvarAdicaoOrEditar(); loader = 'loadingIncluir';\"\n                  class=\"elevation-0\"\n                  color=\"primary\"\n                >\n                  Incluir\n                  <v-icon small right>mdi-plus-circle-outline</v-icon>\n                </v-btn>\n              </div>\n            </template>\n            <template v-else>\n              <v-btn\n                id=\"botao_editar\"\n                :loading=\"loadingEditar\"\n                @click=\"\n                  salvarAdicaoOrEditar();\n                  loader = 'loadingEditar';\n                \"\n                class=\"elevation-0\"\n                color=\"primary\"\n              >\n                Editar\n                <v-icon small right>mdi-pencil-outline</v-icon>\n              </v-btn>\n            </template>\n          </div>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n    <div class=\"bloqueia-tela\" v-if=\"snackAdicoesFechar\"></div>\n    <v-snackbar\n      transition=\"dialog-bottom-transition\"\n      outlined\n      bottom\n      timeout=\"-1\"\n      v-model=\"snackAdicoesFechar\"\n      :elevation=\"8\"\n    >\n      <v-icon color=\"error\" left>mdi-alert-outline</v-icon>\n      <span style=\"color: black; font-weight: 800; font-size: 12px\">Você tem certeza que deseja sair? O preenchimento atual será perdido.</span>\n      <template v-slot:action=\"{ attrs }\">\n        <v-btn\n          small\n          color=\"primary\"\n          style=\"text-transform: none\"\n          v-bind=\"attrs\"\n          text\n          class=\"elevation-0 ml-6\"\n          @click=\"snackAdicoesFechar = false\"\n        >\n          Cancelar\n        </v-btn>\n        <v-btn\n          color=\"primary\"\n          small\n          class=\"ml-2 elevation-0\"\n          v-bind=\"attrs\"\n          @click=\"fechaModalAdicao\"\n          style=\"text-transform: none; color: white\"\n        >\n          Sair\n        </v-btn>\n      </template>\n    </v-snackbar>\n  </div>\n</template>\n<script>\nimport { mapGetters } from \"vuex\";\nimport AbaAdicoes from \"../../Abas/AbaAdicoes/AbaAdicoes.vue\";\nimport Form from \"@/services/modules/form\";\n\nexport default {\n  components: {\n    AbaAdicoes,\n  },\n  props: [\"adicaoEscolhida\"],\n  name: \"ModalAdicoes\",\n  data() {\n    return {\n      snackAdicoesFechar: false,\n      loadingIncluir: false,\n      loadingEditar: false,\n      loader: null,\n    };\n  },\n  created() {\n    this.verificaPesoAdição();\n  },\n\n  watch: {\n    loader() {\n      const l = this.loader;\n      this[l] = !this[l];\n\n      setTimeout(() => (this[l] = false), 6000);\n\n      this.loader = null;\n    },\n    handleModalAdicao(val) {\n      if (val == true) {\n        //esta abrindo aba Incluir adicoes\n        //sempre que abrir alterar modal para aba-Origem\n        this.alterarAba(\"aba-Origem\");\n      } else {\n        this.$store.dispatch('aliquotas/limparAliquotasEAlertas');\n        let form = new Form();\n        form.carregarNovaAdicao();\n      }\n    },\n  },\n  computed: {\n    ...mapGetters(\"adicao\", {\n      adicao: \"getState\",\n    }),\n\n    ...mapGetters(\"consulta\", {\n      consulta: \"getState\",\n    }),\n    adicoes: {\n      get() {\n        return this.$store.state.adicoes.dados;\n      },\n      set(newValue) {\n        if (newValue != this.adicoes) {\n          this.$store.commit(\"adicoes/setDados\", newValue);\n        }\n      },\n    },\n    handleModalAdicao: {\n      get() {\n        return this.$store.state.modalAdicoes.modalAdicoes;\n      },\n      set(newValue) {\n        if (newValue != this.handleModalAdicao) {\n          this.$store.commit(\"modalAdicoes/setModalAdicoes\", newValue);\n        }\n      },\n    },\n    abaAdicoes: {\n      get() {\n        return this.$store.state.abaAdicoes.abaAdicoes;\n      },\n      set(newValue) {\n        if (newValue != this.abaAdicoes) {\n          this.$store.commit(\"abaAdicoes/setAbaAdicoes\", newValue);\n        }\n      },\n    },\n    checkManterExpoFab: {\n      get () {\n        return this.$store.state.abaAdicoes.checkManterExpoFab;\n      },\n      set(val) {\n        this.$store.commit(\"abaAdicoes/setCheckManterExpoFab\", val);\n        if (!val) {\n          this.$store.dispatch('abaAdicoes/removerExpoFabSelecionado');\n        }\n      }\n    },\n  },\n  methods: {\n    downScroll() {\n      let myDiv = document.getElementById(\"modal_adicoes\");\n      setTimeout(function () {\n        // myDiv.scrollTop = myDiv.offsetWidth;\n        myDiv.scrollTop = 1000;\n      }, 500);\n    },\n    fechaModalAdicao() {\n      this.$refs.abaAdicoes.limparFormularios();\n      setTimeout(() => {\n        this.handleModalAdicao = false;\n        this.snackAdicoesFechar = false;\n      }, 200);\n    },\n\n    confirmaFechamentoModalAdicao() {\n      this.snackAdicoesFechar = true;\n    },\n    salvarAdicaoOrEditar() {\n      //TODO:: validacoes para verificar dados obrigátorios\n\n      let verificacao = this.$refs.abaAdicoes.verificaFormularioTributos();\n\n      if (!verificacao) {\n        return false;\n      }\n\n      // calcula a soma dos pesos das adições vs resultado\n      let pesoOutras = 0;\n      this.adicoes.forEach((ad) => {\n        if (ad.id != this.adicao.id) {\n          pesoOutras += parseFloat(ad.peso_liquido_total);\n        }\n      });\n\n      if (\n        pesoOutras + parseFloat(this.adicao.peso_liquido_total) >\n        this.consulta.mercadoria.peso_liquido_total\n      ) {\n        Object.bus.$emit(\"structure\", {\n          type: \"error\",\n          message:\n            \"O peso das adições está acima do peso declarado na consulta\",\n          timeout: 1000,\n        });\n        return false;\n      }\n\n      let pesosItens = 0;\n      //valida o peso dos itens das adições\n      this.adicoes.forEach((i) => {\n        let mostraItem = i.item;\n        mostraItem.forEach((itm) => {\n          pesosItens = pesosItens + parseFloat(itm.peso_unitario);\n        });\n      });\n\n      let dados = JSON.parse(JSON.stringify(this.adicao));\n      dados[\"id_declaracao\"] = this.consulta.id;\n\n      //na hora de editar usuario não alterou moeda, com isso ficou igual o banco mas tem que alterar formato de envio\n      if (typeof dados.moeda == \"object\") {\n        //alterando (objeto moeda) para apenas (string simbolo)\n        dados.moeda = dados.moeda.sigla_moeda;\n      }\n\n      // adicao.exportador_fabricante\n      if (dados.exportador_fabricante) {\n        dados.fabricante = dados.exportador;\n      }\n      let tipoRequest = dados.id == null || dados.id == \"\" ? \"post\" : \"put\";\n\n      this.$root.$api[tipoRequest](\"/adicao\", dados).then(async (response) => {\n        if (response.status == \"200\") {\n          let message =\n            dados.id == null || dados.id == \"\"\n              ? \"Adição criada com sucesso.\"\n              : \"Adição editada com sucesso.\";\n          Object.bus.$emit(\"structure\", {\n            message: message,\n            type: \"success\",\n            timeout: 2000,\n          });\n\n          if (this.checkManterExpoFab && tipoRequest == 'post') {\n            this.$store.dispatch('abaAdicoes/setarExpoFabSelecionado', {\n              exportador: this.adicao.exportador.nome,\n              fabricante: this.adicao.fabricante.nome,\n              paisFabricante: this.adicao.id_pais_fabricante,\n              paisExportador: this.adicao.id_pais_exportador\n            });\n          }\n\n          //TODO:: atualizar lista de adicoes que demonstrada em baixo\n          let id_declaracao = this.consulta.id;\n          this.$store\n            .dispatch(\"adicoes/carregarAdicoes\", id_declaracao)\n            .then(() => {\n              this.fechaModalAdicao();\n            })\n            .catch(() => {\n              Object.bus.$emit(\"structure\", {\n                type: \"error\",\n                message: \"Não foi possível carregar as informações das adicoes\",\n                timeout: 1000,\n              });\n              this.fechaModalAdicao();\n            });\n\n          if (dados.id !== null && dados.id !== \"\") {\n            this.$emit(\"atualizarCabecalhoAdicao\", this.adicao);\n          }\n        } else {\n          //ver se é erros de campos que laravel retornou\n\n          // criar lista de erro ou pega primeiro erro\n          if (\n            typeof response !== \"undefined\" &&\n            typeof response.data !== \"undefined\" &&\n            typeof response.data.errors !== \"undefined\"\n          ) {\n            //irei pegar o primeiro erro\n\n            let listErrors = [];\n            let errors = response.data.errors;\n            Object.keys(errors).forEach(function (element) {\n              listErrors.push(errors[element][0]);\n            });\n\n            Object.bus.$emit(\"structure\", {\n              message: listErrors[0],\n              timeout: 0,\n            });\n\n            return false;\n          }\n\n          if (\n            typeof response !== \"undefined\" &&\n            typeof response.data !== \"undefined\" &&\n            typeof response.data.message !== \"undefined\"\n          ) {\n            Object.bus.$emit(\"structure\", {\n              message: response.data.message,\n              timeout: 0,\n            });\n            return false;\n          }\n        }\n      });\n    },\n    verificaPesoAdição() {\n      let pesosItens = 0;\n      //valida o peso dos itens das adições\n      this.adicoes.forEach((i) => {\n        let mostraItem = i.item;\n        mostraItem.forEach((itm) => {\n          pesosItens = pesosItens + parseFloat(itm.peso_unitario);\n        });\n      });\n\n      if (\n        pesosItens > parseFloat(this.consulta.mercadoria.peso_liquido_total)\n      ) {\n        return false;\n      }\n    },\n\n    proximaEtapa() {\n      if (this.abaAdicoes == \"aba-Origem\") {\n        let verificacao = this.$refs.abaAdicoes.verificaFormularioOrigem();\n        if (verificacao) {\n          this.alterarAba(\"aba-DadosBasicos\");\n        }\n      } else if (this.abaAdicoes == \"aba-DadosBasicos\") {\n        let verificacao =\n          this.$refs.abaAdicoes.verificaFormularioDadosBasicos();\n        if (verificacao) {\n          this.alterarAba(\"aba-Tributos\");\n        }\n      }\n    },\n\n    etapaAnterior() {\n      if (this.abaAdicoes == \"aba-Tributos\") {\n        this.alterarAba(\"aba-DadosBasicos\");\n      } else if (this.abaAdicoes == \"aba-DadosBasicos\") {\n        this.alterarAba(\"aba-Origem\");\n      }\n    },\n\n    alterarAba(aba) {\n      this.abaAdicoes = aba;\n    },\n  },\n};\n</script>\n<style lang=\"scss\">\n.position-button {\n  float: right;\n}\n.tab {\n  position: relative;\n\n  .barra-acoes {\n    opacity: 1;\n    background: rgba(255, 255, 255);\n    height: 40px;\n    border-bottom: 1px solid #b7c2cc;\n    z-index: 150;\n    position: sticky;\n    right: 0;\n    top: 0;\n    left: 0;\n  }\n\n  @supports ((-webkit-backdrop-filter: none) or (backdrop-filter: none)) {\n    .barra-acoes {\n      background-color: rgba(255, 255, 255, 0.6) !important;\n      backdrop-filter: blur(5px) !important;\n      -webkit-backdrop-filter: blur(5px) !important;\n    }\n  }\n}\n\n.v-dialog > .v-card > .v-card__text {\n  padding: 0 0px 8px !important;\n}\n\n.custom-loader {\n  animation: loader 1s infinite;\n  display: flex;\n}\n@-moz-keyframes loader {\n  from {\n    transform: rotate(0);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n@-webkit-keyframes loader {\n  from {\n    transform: rotate(0);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n@-o-keyframes loader {\n  from {\n    transform: rotate(0);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n@keyframes loader {\n  from {\n    transform: rotate(0);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n</style>"]}]}