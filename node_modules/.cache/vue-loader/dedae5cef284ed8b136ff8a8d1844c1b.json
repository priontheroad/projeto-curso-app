{"remainingRequest":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/src/components/ArquivosDiversos/Modal/ModalItem.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/src/components/ArquivosDiversos/Modal/ModalItem.vue","mtime":1678361197239},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/priscila_floriano/Documentos/diversos/rateio-importacao-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoudi1pbnB1dF9fYXBwZW5kLWlubmVyIC52LWljb24gewogIGZvbnQtc3R5bGU6IG5vcm1hbCAhaW1wb3J0YW50OwogIGZvbnQtd2VpZ2h0OiBub3JtYWw7CiAgbWFyZ2luLXJpZ2h0OiAxNnB4Owp9Cg=="},{"version":3,"sources":["ModalItem.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgUA;AACA;AACA;AACA;AACA","file":"ModalItem.vue","sourceRoot":"src/components/ArquivosDiversos/Modal","sourcesContent":["<template>\n  <v-dialog v-model=\"modalItem\" v-if=\"modalItem\" persistent class=\"fundo-branco\">\n    <v-card class=\"elevation-0 adicao-item\">\n      <v-card-title>\n        <div class=\"d-flex justify-space-between\" style=\"min-width: 100%\">\n          <h3 class=\"standard-subtitle\">{{ dados.id ? 'Editar' : 'Adicionar' }} Item</h3>\n          <v-btn @click=\"modalItem = false\" icon color=\"red\" class=\"text-h6\">\n            <v-icon>mdi-close</v-icon>\n          </v-btn>\n        </div>\n      </v-card-title>\n      <v-card-text>\n        <v-row no-gutters justify=\"center\">\n          <v-col cols=\"11\">\n            <v-row justify=\"center\">\n              <v-col cols=\"12\">\n                <label for=\"\" class=\"text-caption font-weight-bold\">Descrição</label>\n                <v-textarea\n                  :maxlength=\"3000\"\n                  v-model=\"dados.descricao\"\n                  placeholder=\"Descrição do item\"\n                  outlined\n                  dense\n                  :error-messages=\"descricaoErrors\"\n                />\n              </v-col>\n            </v-row>\n            <v-row justify=\"center\">\n              <v-col cols=\"4\">\n                <label for=\"Peso Unitário\" class=\"text-caption font-weight-bold\">Peso Unitário</label>\n                <CampoMonetario \n                  v-model=\"dados.peso_unitario\"\n                  :intDecimais=\"9\"\n                  appendIcon=\"Kg\"\n                  :errorMessages=\"pesoUnitarioErrors\"\n                  :blHideDetails=\"false\"\n                />\n              </v-col>\n              <v-col cols=\"4\">\n                <label for=\"\" class=\"text-caption font-weight-bold\">Valor Unitário</label>\n                <CampoMonetario \n                  v-model=\"dados.vucv\"\n                  :intDecimais=\"7\"\n                  :appendIcon=\"adicaoEscolhida.moeda.sigla_moeda\"\n                  :errorMessages=\"valorUnitarioErrors\"\n                />\n              </v-col>\n              <v-col cols=\"4\">\n                <label for=\"Quantidade\" class=\"text-caption font-weight-bold\">Quantidade</label>\n                <CampoMonetario \n                  v-model=\"dados.quantidade\" \n                  :intDecimais=\"5\"\n                  :appendIcon=\"siglaUnidadeMedida\"\n                  :errorMessages=\"quantidadeErrors\"\n                />\n              </v-col>\n            </v-row>\n            <v-row>\n              <v-col cols=\"4\" v-if=\"mostraAntidumping\">\n                <label for=\"Antidumping\" class=\"text-caption font-weight-bold\">Antidumping</label>\n                <CampoMonetario \n                  v-model=\"dados.antidumping\" \n                  :errorMessages=\"antidumpingErrors\" \n                />\n              </v-col>\n              <v-col cols=\"4\" v-if=\"mostrarCide\">\n                <label for=\"CIDE Combustíveis\" class=\"text-caption font-weight-bold\">CIDE Combustíveis</label>\n                <CampoMonetario \n                  v-model=\"dados.cide_combustiveis.valor\" \n                  :error-messages=\"cideErrors\" \n                />\n              </v-col>\n            </v-row>\n          </v-col>\n        </v-row>\n      </v-card-text>\n      <v-card-actions>\n        <v-row no-gutters justify=\"center\" class=\"my-2\">\n          <v-col cols=\"6\" align=\"start\" cl>\n            <v-btn @click=\"modalItem = false\" color=\"primary\" text elevation=\"0\">\n              <v-icon left>mdi-close</v-icon> Cancelar\n            </v-btn>\n          </v-col>\n          <v-col cols=\"6\" align=\"end\" class=\"pr-3\">\n            <v-btn @click=\"atualizarItem\" elevation=\"0\" color=\"primary\">\n              Salvar <v-icon right>mdi-pencil-outline</v-icon>\n            </v-btn>\n          </v-col>\n        </v-row>\n      </v-card-actions>\n    </v-card>\n  </v-dialog>\n</template>\n<script>\nimport { mapGetters } from \"vuex\";\nimport formataMoedaMixin from \"@/mixins/formataMoedaMixin\";\n\nexport default {\n  name: \"ModalItem\",\n\n  props: [\"visible\", \"adicaoEscolhida\", \"siglaUnidadeMedida\"],\n\n  mixins: [ formataMoedaMixin ],\n\n  created() {\n    // this.$v.reset();\n  },\n\n  data() {\n    return {\n      dados: {\n\t\t\t\tid: \"\",\n\t\t\t\tid_adicao: \"\",\n\t\t\t\tdescricao: \"\",\n\t\t\t\tquantidade: \"\",\n\t\t\t\tpeso_unitario: \"\",\n\t\t\t\tvalor_unitario: \"\",\n\t\t\t\tvmcv: \"\",\n\t\t\t\tantidumping: \"\",\n\t\t\t\tvucv: \"\",\n\t\t\t\tcide_combustiveis: {\n\t\t\t\t\tvalor: \"\"\n\t\t\t\t}\n\t\t\t},\n    };\n  },\n\n  validations: {\n    \"dados.descricao\": {\n      checked() {\n        return !(this.dados.descricao == null || this.dados.descricao == \"\");\n      },\n    },\n    \"dados.peso_unitario\": {\n      checked() {\n        return this.validarTotalPeso(); // !(this.dados.peso_unitario == null || this.dados.peso_unitario == \"\");\n      },\n    },\n    \"dados.valor_unitario\": {\n      checked() {\n        return !(this.dados.vucv == null || this.dados.vucv == \"\");\n      },\n    },\n    \"dados.quantidade\": {\n      checked() {\n        return !(this.dados.quantidade == null || this.dados.quantidade == \"\");\n      },\n    },\n    \"dados.cide_combustiveis.valor\": {\n      checked() {\n        if (!this.mostrarCide) {\n          return true;\n        }\n        return this.validarTotalCide();\n      },\n    },\n    \"dados.antidumping\": {\n      checked() {\n        if (!this.mostraAntidumping) {\n          return true;\n        }\n        return this.validarTotalAntiduming();\n      },\n    },\n  },\n\n  computed: {\n    ...mapGetters(\"adicao\", { \n      adicao: \"getState\" \n    }),\n    ...mapGetters(\"itens\", {\n      listaItens: \"getListaItens\",\n    }),\n    mostraAntidumping() {\n      return this.adicaoEscolhida.antidumping > 0;\n    },\n    mostrarCide() {\n      return this.adicaoEscolhida.tributacoes.cide_combustiveis && this.adicaoEscolhida.tributacoes.cide_combustiveis.valor > 0;\n    },\n    cideErrors() {\n      const errors = [];\n      if (!this.$v[\"dados.cide_combustiveis.valor\"].$dirty) return errors;\n      !this.$v[\"dados.cide_combustiveis.valor\"].checked && errors.push(\"\");\n      return errors;\n    },\n    descricaoErrors() {\n      const errors = [];\n      if (!this.$v[\"dados.descricao\"].$dirty) return errors;\n      !this.$v[\"dados.descricao\"].checked && errors.push(\"\");\n      return errors;\n    },\n    pesoUnitarioErrors() {\n      const errors = [];\n      if (!this.$v[\"dados.peso_unitario\"].$dirty) return errors;\n      !this.$v[\"dados.peso_unitario\"].checked && errors.push(\"Peso excedente, favor revisar os pesos e quantidades da adição.\");\n      return errors;\n    },\n    valorUnitarioErrors() {\n      const errors = [];\n      if (!this.$v[\"dados.valor_unitario\"].$dirty) return errors;\n      !this.$v[\"dados.valor_unitario\"].checked && errors.push(\"\");\n      return errors;\n    },\n    quantidadeErrors() {\n      const errors = [];\n      if (!this.$v[\"dados.quantidade\"].$dirty) return errors;\n      !this.$v[\"dados.quantidade\"].checked && errors.push(\"\");\n      return errors;\n    },\n    antidumpingErrors() {\n      const errors = [];\n      if (!this.$v[\"dados.antidumping\"].$dirty) return errors;\n      !this.$v[\"dados.antidumping\"].checked && errors.push(\"\");\n      return errors;\n    },\n    modalItem: {\n      get() {\n        return this.visible;\n      },\n      set(value) {\n        if (!value) {\n          this.$emit(\"close\");\n        }\n      },\n    },\n  },\n  methods: {\n    validarTotalCide() {\n      let cideAdicao = parseFloat(this.adicaoEscolhida.tributacoes.cide_combustiveis.valor);\n      let totalCideItem = parseFloat(this.dados.cide_combustiveis.valor);\n\n      if (this.listaItens) {\n        this.listaItens.forEach((item) => {\n          if (item.id != this.dados.id) {\n            totalCideItem += parseFloat(item.cide_combustiveis.valor);\n          }\n        });\n      }\n\n      return totalCideItem <= cideAdicao;\n    },\n\n    validarTotalPeso() {\n      let pesoAdicao = parseFloat(this.adicaoEscolhida.peso_liquido_total);\n      let totalPesoItem = parseFloat(this.dados.peso_unitario) * parseFloat(this.dados.quantidade);\n\n      if (this.listaItens?.length > 0) {\n        this.listaItens.forEach((item) => {\n          if (item.id != this.dados.id) {\n            totalPesoItem += (parseFloat(item.peso_unitario) * parseFloat(item.quantidade));\n          }\n        });\n      }\n\n      return totalPesoItem.toFixed(5) <= pesoAdicao;\n    },\n\n    validarTotalAntiduming() {\n      let antidumpingAdicao = parseFloat(this.adicaoEscolhida.antidumping);\n      let totalAntidumpingItem = parseFloat(this.dados.antidumping);\n\n      if (this.listaItens) {\n        this.listaItens.forEach((item) => {\n          if (item.id != this.dados.id) {\n            totalAntidumpingItem += parseFloat(item.antidumping);\n          }\n        });\n      }\n\n      return totalAntidumpingItem <= antidumpingAdicao;\n    },\n\n    async atualizarItem() {\n      this.$v.$touch();\n      if (this.$v.$invalid) {\n        return;\n      }\n\n      let obSalvar = {\n        'id_adicao': this.adicaoEscolhida.id,\n        'descricao': this.dados.descricao,\n        'quantidade': this.dados.quantidade,\n        'peso_unitario': this.dados.peso_unitario,\n        'vucv': this.dados.vucv,\n        'vmcv': parseFloat(this.dados.vucv) * parseFloat(this.dados.quantidade),\n        'antidumping': this.mostraAntidumping ? this.dados.antidumping : 0,\n        'cide_combustiveis': {\n          'valor': this.mostrarCide ? this.dados.cide_combustiveis.valor : 0\n        },\n      };\n      \n      let response;\n      if (this.dados.id) {\n        obSalvar.id_item = this.dados.id;\n        response = await this.$root.$api.put('/item', obSalvar);\n      } else {\n        response = await this.$root.$api.post('/item', obSalvar);\n      }\n      \n      if (response.status == 200) {\n        this.$emit(\"atualizarDados\");\n        this.$emit(\"close\");\n      } else {\n        Object.bus.$emit(\"structure\", {\n          type: \"error\",\n          message:\n            \"Erro ao salvar item. Verifique os dados e tente novamente.\",\n          timeout: 10000,\n        });\n      }\n    },\n\n    carregandoDados(objeto) {\n      this.$v.$reset();\n      this.dados = objeto;\n    },\n  },\n};\n</script>\n<style lang=\"scss\">\n.v-input__append-inner .v-icon {\n  font-style: normal !important;\n  font-weight: normal;\n  margin-right: 16px;\n}\n</style>\n"]}]}